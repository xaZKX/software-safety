## 实验目的

2. 上一题的程序中，修改的显示内容变为一个很长的字符串（至少2kb长）。并且保证程序正常运行不崩溃。(提示，可执行文件中原有的空间有限，必须要新加入数据，加入数据后必须要修改.text字段中的指针。)

## 实验过程

### 修改的显示内容变为一个很长的字符串(至少2kb)

- 查看PE文件头。`dumpbin /headers exp1.exe`。其中基地址(ImageBase)为「400000h」。

  ![](images/headers.png)

  

- 查看反汇编。`dumpbin /disasm exp1.exe`。其中「4003F0h」对应字符串“test”；「4003F8h」对应“hello world”。根据基地址，计算出“test”的地址为：4003F0h-400000h=3F0h；“hello cuc”的地址为：4003F8h-400000h=3F8h；

  ![](images/disasm.png)

- 在winhex中查看二进制文件，验证偏移地址。

  ![](images/offset.png)

- 在winhex中在最后面增加任意字符。

  ![](images/addchar.png)

- 修改原本指向hello world的指针地址「03F8h」，使其指向新的地址「0420h」。

  ![](images/origin.png)

  ![](images/modify.png)

- 保存修改后的文件，再次执行exp1.exe，可以看到此时弹出长消息字符串的消息框。

  ![](images/result.png)

